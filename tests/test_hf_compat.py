# Generated by Claude
"""Tests for HuggingFace compatibility helpers."""

from oyez_sa_asr.hf_compat import datasets_version, is_v4, supports_loading_scripts


class TestDatasetsVersion:
    """Tests for datasets_version function."""

    def test_returns_version_string(self) -> None:
        """Returns a version string."""
        version = datasets_version()
        assert isinstance(version, str)
        assert "." in version  # Should have dots like "4.5.0"

    def test_version_is_parseable(self) -> None:
        """Version can be parsed by packaging."""
        from packaging.version import parse as version_parse  # noqa: PLC0415

        version = datasets_version()
        parsed = version_parse(version)
        assert parsed is not None


class TestSupportsLoadingScripts:
    """Tests for supports_loading_scripts function."""

    def test_returns_bool(self) -> None:
        """Returns a boolean value."""
        result = supports_loading_scripts()
        assert isinstance(result, bool)

    def test_consistent_with_version(self) -> None:
        """Result is consistent with version check."""
        from packaging.version import parse as version_parse  # noqa: PLC0415

        version = datasets_version()
        expected = version_parse(version) < version_parse("4.0.0")
        assert supports_loading_scripts() == expected


class TestIsV4:
    """Tests for is_v4 function."""

    def test_returns_bool(self) -> None:
        """Returns a boolean value."""
        result = is_v4()
        assert isinstance(result, bool)

    def test_opposite_of_supports_loading_scripts(self) -> None:
        """is_v4 is the opposite of supports_loading_scripts."""
        assert is_v4() == (not supports_loading_scripts())

    def test_consistent_with_version(self) -> None:
        """Result is consistent with version check."""
        from packaging.version import parse as version_parse  # noqa: PLC0415

        version = datasets_version()
        expected = version_parse(version) >= version_parse("4.0.0")
        assert is_v4() == expected
