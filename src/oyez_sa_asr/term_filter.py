# Generated by Claude
"""Term filtering utilities for CLI commands."""

from collections.abc import Callable, Iterable
from pathlib import Path
from typing import TypeVar

T = TypeVar("T")


def filter_by_terms(
    items: Iterable[T],
    get_term: Callable[[T], str],
    terms: list[str] | None,
) -> list[T]:
    """Filter items by term if terms specified, else return all.

    Args:
        items: Iterable of items to filter.
        get_term: Function to extract term string from an item.
        terms: List of terms to include, or None/empty for all.

    Returns
    -------
        Filtered list of items matching the terms.
    """
    items_list = list(items)
    if not terms:
        return items_list
    term_set = set(terms)
    return [item for item in items_list if get_term(item) in term_set]


def filter_dirs(dirs: Iterable[Path], terms: list[str] | None) -> list[Path]:
    """Filter directories by term name.

    Args:
        dirs: Iterable of directory paths.
        terms: List of term names to include, or None/empty for all.

    Returns
    -------
        Filtered list of directories.
    """
    return filter_by_terms(list(dirs), lambda d: d.name, terms)
